<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>构建MineCraft原型 | aiplayer</title>
    <meta name="description" content="aiplayer portal">
    <meta name="generator" content="VuePress 1.4.0">
    
    
    <link rel="preload" href="/assets/css/0.styles.f0b62ee8.css" as="style"><link rel="preload" href="/assets/js/app.db1f5619.js" as="script"><link rel="preload" href="/assets/js/2.136755fd.js" as="script"><link rel="preload" href="/assets/js/75.8afa1dc5.js" as="script"><link rel="prefetch" href="/assets/js/10.d8e1a177.js"><link rel="prefetch" href="/assets/js/100.a1569435.js"><link rel="prefetch" href="/assets/js/101.df4254c0.js"><link rel="prefetch" href="/assets/js/102.7238a621.js"><link rel="prefetch" href="/assets/js/103.6066a045.js"><link rel="prefetch" href="/assets/js/104.19e5f9ce.js"><link rel="prefetch" href="/assets/js/105.1da234c6.js"><link rel="prefetch" href="/assets/js/106.205e3402.js"><link rel="prefetch" href="/assets/js/107.175ad760.js"><link rel="prefetch" href="/assets/js/108.a9ac042b.js"><link rel="prefetch" href="/assets/js/109.424d5783.js"><link rel="prefetch" href="/assets/js/11.934355de.js"><link rel="prefetch" href="/assets/js/110.c7bca671.js"><link rel="prefetch" href="/assets/js/111.73c2c60a.js"><link rel="prefetch" href="/assets/js/112.7f5490ea.js"><link rel="prefetch" href="/assets/js/113.14375c6f.js"><link rel="prefetch" href="/assets/js/114.3363197a.js"><link rel="prefetch" href="/assets/js/115.02afb483.js"><link rel="prefetch" href="/assets/js/116.29a7b694.js"><link rel="prefetch" href="/assets/js/117.5be07a33.js"><link rel="prefetch" href="/assets/js/118.0702142c.js"><link rel="prefetch" href="/assets/js/119.6402e457.js"><link rel="prefetch" href="/assets/js/12.c2bc3227.js"><link rel="prefetch" href="/assets/js/120.ac365fc7.js"><link rel="prefetch" href="/assets/js/121.fb021e50.js"><link rel="prefetch" href="/assets/js/122.9fe3b1ea.js"><link rel="prefetch" href="/assets/js/123.27e74ba8.js"><link rel="prefetch" href="/assets/js/124.1d2e32db.js"><link rel="prefetch" href="/assets/js/125.04e7f173.js"><link rel="prefetch" href="/assets/js/126.27d517fd.js"><link rel="prefetch" href="/assets/js/127.64ce51be.js"><link rel="prefetch" href="/assets/js/128.5c40af31.js"><link rel="prefetch" href="/assets/js/129.8e36099a.js"><link rel="prefetch" href="/assets/js/13.30b2fd23.js"><link rel="prefetch" href="/assets/js/130.4404aeed.js"><link rel="prefetch" href="/assets/js/131.9a6be204.js"><link rel="prefetch" href="/assets/js/132.621634ca.js"><link rel="prefetch" href="/assets/js/133.4b393036.js"><link rel="prefetch" href="/assets/js/134.dcc9e5f3.js"><link rel="prefetch" href="/assets/js/135.cdc08eed.js"><link rel="prefetch" href="/assets/js/136.d1361c7f.js"><link rel="prefetch" href="/assets/js/137.70e249cd.js"><link rel="prefetch" href="/assets/js/138.ab5deb19.js"><link rel="prefetch" href="/assets/js/139.11778cf5.js"><link rel="prefetch" href="/assets/js/14.2125223a.js"><link rel="prefetch" href="/assets/js/140.db04184d.js"><link rel="prefetch" href="/assets/js/141.f31f6358.js"><link rel="prefetch" href="/assets/js/142.46e9b5b9.js"><link rel="prefetch" href="/assets/js/143.fa46c1c3.js"><link rel="prefetch" href="/assets/js/144.578e8fe1.js"><link rel="prefetch" href="/assets/js/145.d92b6019.js"><link rel="prefetch" href="/assets/js/146.7959a0f8.js"><link rel="prefetch" href="/assets/js/147.bddc1b3f.js"><link rel="prefetch" href="/assets/js/148.226bfada.js"><link rel="prefetch" href="/assets/js/149.d8549551.js"><link rel="prefetch" href="/assets/js/15.fb8b9ae9.js"><link rel="prefetch" href="/assets/js/150.9e86241e.js"><link rel="prefetch" href="/assets/js/151.796f1274.js"><link rel="prefetch" href="/assets/js/152.d257e8a9.js"><link rel="prefetch" href="/assets/js/153.03854e57.js"><link rel="prefetch" href="/assets/js/154.36494ed7.js"><link rel="prefetch" href="/assets/js/155.a4c0d865.js"><link rel="prefetch" href="/assets/js/156.a5570edb.js"><link rel="prefetch" href="/assets/js/157.d5cfe341.js"><link rel="prefetch" href="/assets/js/16.4840c375.js"><link rel="prefetch" href="/assets/js/17.3db7187c.js"><link rel="prefetch" href="/assets/js/18.3f978365.js"><link rel="prefetch" href="/assets/js/19.0a024717.js"><link rel="prefetch" href="/assets/js/20.8bce2b97.js"><link rel="prefetch" href="/assets/js/21.eb505a2a.js"><link rel="prefetch" href="/assets/js/22.ad76dfcb.js"><link rel="prefetch" href="/assets/js/23.c086b548.js"><link rel="prefetch" href="/assets/js/24.3fb5d63e.js"><link rel="prefetch" href="/assets/js/25.5595455f.js"><link rel="prefetch" href="/assets/js/26.f94f11ad.js"><link rel="prefetch" href="/assets/js/27.f289b5d4.js"><link rel="prefetch" href="/assets/js/28.6eb0556e.js"><link rel="prefetch" href="/assets/js/29.8defe1c0.js"><link rel="prefetch" href="/assets/js/3.28f81bc4.js"><link rel="prefetch" href="/assets/js/30.8ab8f249.js"><link rel="prefetch" href="/assets/js/31.33b536a9.js"><link rel="prefetch" href="/assets/js/32.7df14067.js"><link rel="prefetch" href="/assets/js/33.fbabe129.js"><link rel="prefetch" href="/assets/js/34.53ff114a.js"><link rel="prefetch" href="/assets/js/35.f2c39ebd.js"><link rel="prefetch" href="/assets/js/36.467f6b09.js"><link rel="prefetch" href="/assets/js/37.9e1dd23b.js"><link rel="prefetch" href="/assets/js/38.068c85f4.js"><link rel="prefetch" href="/assets/js/39.b1e0fefa.js"><link rel="prefetch" href="/assets/js/4.8934782b.js"><link rel="prefetch" href="/assets/js/40.bb170fba.js"><link rel="prefetch" href="/assets/js/41.f3ae6a10.js"><link rel="prefetch" href="/assets/js/42.bb54411b.js"><link rel="prefetch" href="/assets/js/43.3c863cb9.js"><link rel="prefetch" href="/assets/js/44.7060ca63.js"><link rel="prefetch" href="/assets/js/45.f3047d76.js"><link rel="prefetch" href="/assets/js/46.9c09c0ab.js"><link rel="prefetch" href="/assets/js/47.5202a7c1.js"><link rel="prefetch" href="/assets/js/48.6e8df322.js"><link rel="prefetch" href="/assets/js/49.0cc3d23d.js"><link rel="prefetch" href="/assets/js/5.a0353814.js"><link rel="prefetch" href="/assets/js/50.3b307fd5.js"><link rel="prefetch" href="/assets/js/51.4fbbe6c7.js"><link rel="prefetch" href="/assets/js/52.331937fe.js"><link rel="prefetch" href="/assets/js/53.dc7c275c.js"><link rel="prefetch" href="/assets/js/54.4f85d82e.js"><link rel="prefetch" href="/assets/js/55.1643757b.js"><link rel="prefetch" href="/assets/js/56.ef32a88b.js"><link rel="prefetch" href="/assets/js/57.c7121932.js"><link rel="prefetch" href="/assets/js/58.16441501.js"><link rel="prefetch" href="/assets/js/59.4e5591f5.js"><link rel="prefetch" href="/assets/js/6.fa571ebd.js"><link rel="prefetch" href="/assets/js/60.967020e8.js"><link rel="prefetch" href="/assets/js/61.71d79f42.js"><link rel="prefetch" href="/assets/js/62.88671447.js"><link rel="prefetch" href="/assets/js/63.7f40e91d.js"><link rel="prefetch" href="/assets/js/64.ef23913e.js"><link rel="prefetch" href="/assets/js/65.63a29bbb.js"><link rel="prefetch" href="/assets/js/66.9f830dea.js"><link rel="prefetch" href="/assets/js/67.0783e6f9.js"><link rel="prefetch" href="/assets/js/68.edb28c91.js"><link rel="prefetch" href="/assets/js/69.58a85f29.js"><link rel="prefetch" href="/assets/js/7.b690ca65.js"><link rel="prefetch" href="/assets/js/70.58d4adb6.js"><link rel="prefetch" href="/assets/js/71.0e2e4dba.js"><link rel="prefetch" href="/assets/js/72.ee7e2979.js"><link rel="prefetch" href="/assets/js/73.935f8492.js"><link rel="prefetch" href="/assets/js/74.d69c06e4.js"><link rel="prefetch" href="/assets/js/76.48c0a6d0.js"><link rel="prefetch" href="/assets/js/77.5e0afc33.js"><link rel="prefetch" href="/assets/js/78.9cb7dc28.js"><link rel="prefetch" href="/assets/js/79.83ec5e2e.js"><link rel="prefetch" href="/assets/js/8.f127e12e.js"><link rel="prefetch" href="/assets/js/80.3776af5c.js"><link rel="prefetch" href="/assets/js/81.539223a8.js"><link rel="prefetch" href="/assets/js/82.ecd88fed.js"><link rel="prefetch" href="/assets/js/83.8b8f52b1.js"><link rel="prefetch" href="/assets/js/84.56e7b62b.js"><link rel="prefetch" href="/assets/js/85.602daf28.js"><link rel="prefetch" href="/assets/js/86.8983b155.js"><link rel="prefetch" href="/assets/js/87.92548279.js"><link rel="prefetch" href="/assets/js/88.1683e878.js"><link rel="prefetch" href="/assets/js/89.57d67dae.js"><link rel="prefetch" href="/assets/js/9.beeca559.js"><link rel="prefetch" href="/assets/js/90.86c4ccad.js"><link rel="prefetch" href="/assets/js/91.b97628b5.js"><link rel="prefetch" href="/assets/js/92.13b4c677.js"><link rel="prefetch" href="/assets/js/93.91e9ad39.js"><link rel="prefetch" href="/assets/js/94.bfd2d19e.js"><link rel="prefetch" href="/assets/js/95.89405747.js"><link rel="prefetch" href="/assets/js/96.de120589.js"><link rel="prefetch" href="/assets/js/97.72fa8b0f.js"><link rel="prefetch" href="/assets/js/98.debed4eb.js"><link rel="prefetch" href="/assets/js/99.992e6d93.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f0b62ee8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">aiplayer</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/arjs/" class="nav-link">
  AR.js
</a></div><div class="nav-item"><a href="/aframe/" class="nav-link router-link-active">
  aframe
</a></div><div class="nav-item"><a href="/nunustudio/" class="nav-link">
  nunuStudio
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  关于
</a></div> <a href="https://github.com/aiplayer/aiplayer.github.io.git" target="_blank" rel="noopener noreferrer" class="repo-link">
    Aiplayer
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/arjs/" class="nav-link">
  AR.js
</a></div><div class="nav-item"><a href="/aframe/" class="nav-link router-link-active">
  aframe
</a></div><div class="nav-item"><a href="/nunustudio/" class="nav-link">
  nunuStudio
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  关于
</a></div> <a href="https://github.com/aiplayer/aiplayer.github.io.git" target="_blank" rel="noopener noreferrer" class="repo-link">
    Aiplayer
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>aframe</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/aframe/" class="sidebar-link">AFrame:构建VR应用框架</a></li><li><a href="/aframe/aframe-base.html" class="sidebar-link">AFrame基础</a></li><li><a href="/aframe/aframe-guide.html" class="sidebar-link">开发指南</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>API</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/aframe/aframe-api.html" class="sidebar-link">核心API</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>组件</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/aframe/aframe-component.html" class="sidebar-link">组件</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>原语</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/aframe/aframe-primitive.html" class="sidebar-link">AFrame基础控件</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="构建minecraft原型"><a href="#构建minecraft原型" class="header-anchor">#</a> 构建MineCraft原型</h1> <p>让我们来构建一个基本的Minecraft（体素构建器）演示，目标是带有控制器的房间级虚拟现实（例如，Vive，Rift）。该示例在移动和桌面上的可用性最低。</p> <h2 id="骨架示例"><a href="#骨架示例" class="header-anchor">#</a> 骨架示例</h2> <p>我们将从这个框架HTML开始：</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;script src=&quot;https://aframe.io/releases/1.0.4/aframe.min.js&quot;&gt;&lt;/script&gt;

&lt;body&gt;
  &lt;a-scene&gt;
  &lt;/a-scene&gt;
&lt;/body&gt;

</code></pre></div><h2 id="添加地面"><a href="#添加地面" class="header-anchor">#</a> 添加地面</h2> <a-plane>和<a-circle>是常用于添加地面的基本基元。我们将使用<a-collinder>来更好地使用我们的控制器将使用的光线投射器。圆柱体的半径为30米，与我们稍后将添加的天空半径相匹配。请注意，A帧单位以米为单位，以匹配从WebVR API返回的实际单位。
<p>我们将使用的地面纹理位于https://cdn.aframe.io/a-painter/images/floor.jpg”。我们将向资源添加纹理，并创建指向该纹理的细圆柱体实体：</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;script src=&quot;https://aframe.io/releases/1.0.4/aframe.min.js&quot;&gt;&lt;/script&gt;

&lt;a-scene&gt;
  &lt;a-cylinder id=&quot;ground&quot; src=&quot;https://cdn.aframe.io/a-painter/images/floor.jpg&quot; radius=&quot;32&quot; height=&quot;0.1&quot;&gt;&lt;/a-cylinder&gt;
&lt;/a-scene&gt;
</code></pre></div><h2 id="预加载资产"><a href="#预加载资产" class="header-anchor">#</a> 预加载资产</h2> <p>通过src属性指定URL将在运行时加载纹理。由于网络请求会对渲染性能产生负面影响，因此我们可以预加载纹理，以便场景在获取其资源之前不会开始渲染。我们可以使用资产管理系统来完成这项工作。</p> <p>我们将<a-assets>放置到<a-scene>中，将资源（如图像、视频、模型、声音）放置到<a-assets>中，并通过选择器（如myTexture）从实体指向它们。</a-assets></a-scene></a-assets></p> <p>让我们使用<img>元素将地面纹理移动到<a-assets>以进行预加载：</a-assets></p> <div class="language- extra-class"><pre class="language-text"><code>&lt;script src=&quot;https://aframe.io/releases/1.0.4/aframe.min.js&quot;&gt;&lt;/script&gt;

&lt;a-scene&gt;
  &lt;a-assets&gt;
    &lt;img id=&quot;groundTexture&quot; src=&quot;https://cdn.aframe.io/a-painter/images/floor.jpg&quot;&gt;
  &lt;/a-assets&gt;

  &lt;a-cylinder id=&quot;ground&quot; src=&quot;#groundTexture&quot; radius=&quot;32&quot; height=&quot;0.1&quot;&gt;&lt;/a-cylinder&gt;
&lt;/a-scene&gt;
</code></pre></div><h2 id="添加背景"><a href="#添加背景" class="header-anchor">#</a> 添加背景</h2> <p>让我们使用<a-sky>元素将360°背景添加到<a-scene>中。<a-sky>是一个大的三维球体，其内部映射有一个材质。与普通图像一样，<a-sky>可以使用src进行图像路径。这最终让我们可以用一行HTML制作360°沉浸式图像。作为以后的练习，尝试使用Flickr等矩形池中的一些360°图像。</a-sky></a-sky></a-scene></a-sky></p> <p>我们可以添加纯色背景（例如<a-sky color="“#333”"></a-sky>）或渐变，但我们可以添加带图像的纹理背景。我们使用的图像位于https://cdn.aframe.io/a-painter/images/sky.jpg。</p> <p>我们使用的图像纹理覆盖了半球体，因此我们将使用theta length=“90”将球体切成两半，并将球体的半径设置为30米以匹配地面：</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;script src=&quot;https://aframe.io/releases/1.0.4/aframe.min.js&quot;&gt;&lt;/script&gt;

&lt;a-scene&gt;
  &lt;a-assets&gt;
    &lt;img id=&quot;groundTexture&quot; src=&quot;https://cdn.aframe.io/a-painter/images/floor.jpg&quot;&gt;
    &lt;img id=&quot;skyTexture&quot; src=&quot;https://cdn.aframe.io/a-painter/images/sky.jpg&quot;&gt;
  &lt;/a-assets&gt;

  &lt;a-cylinder id=&quot;ground&quot; src=&quot;#groundTexture&quot; radius=&quot;30&quot; height=&quot;0.1&quot;&gt;&lt;/a-cylinder&gt;

  &lt;a-sky id=&quot;background&quot; src=&quot;#skyTexture&quot; theta-length=&quot;90&quot; radius=&quot;30&quot;&gt;&lt;/a-sky&gt;
&lt;/a-scene&gt;
</code></pre></div><h2 id="添加体素"><a href="#添加体素" class="header-anchor">#</a> 添加体素</h2> <p>我们的虚拟现实应用程序中的体素类似于<a-box>，但附加了一些自定义a-Frame组件。但首先让我们回顾一下实体组件模式。让我们看看如何在引擎盖下组合易于使用的基本体，如<a-box>。</a-box></a-box></p> <p>本节稍后将深入研究一对a-Frame组件的实现。不过，在实践中，我们经常会通过已经由A-Frame社区开发人员编写的HTML使用组件，而不是从头开始构建它们。</p> <h2 id="实体组件模式"><a href="#实体组件模式" class="header-anchor">#</a> 实体组件模式</h2> <p>A-Frame场景中的每个对象都是<A-entity>，它本身不做任何事情，就像一个空的<div>。我们将组件（不要与Web或React组件混淆）插入到该实体中，以提供外观、行为和逻辑。</div></A-entity></p> <p>对于长方体，我们附加并配置a形框架的基本几何和材质组件。。下面是<a-box>分解为其基本组件的样子。<a-box>包装组件：</a-box></a-box></p> <div class="language- extra-class"><pre class="language-text"><code>&lt;!-- &lt;a-box color=&quot;red&quot; depth=&quot;0.5&quot; height=&quot;0.5&quot; shader=&quot;flat&quot; width=&quot;0.5&quot;&gt;&lt;/a-box&gt; --&gt;
&lt;a-entity geometry=&quot;primitive: box; depth: 0.5; height: 0.5; width 0.5&quot;
          material=&quot;color: red; shader: standard&quot;&gt;
&lt;/a-entity&gt;
</code></pre></div><p>组件的好处是它们是可组合的。我们可以从一堆现有组件中进行混合和匹配，以构造不同类型的对象。在三维开发中，我们可能构造的对象类型在数量和复杂性上是无限的，我们需要一种简单的方法来定义新的对象类型，而不是通过传统的继承。与此形成对比的是2dweb，我们使用一个固定HTML元素的小池进行开发，并将它们放到一个层次结构中。</p> <h2 id="随机颜色分量"><a href="#随机颜色分量" class="header-anchor">#</a> 随机颜色分量</h2> <p>A-Frame中的组件是用JavaScript定义的，它们可以完全访问3.js和domapi；它们可以做任何事情。我们将所有对象定义为一组组件。</p> <p>我们将通过编写一个A-Frame组件来设置框上的随机颜色，从而使模式生效。组件注册到AFRAME.registerComponent。我们可以定义一个模式（组件的数据）和生命周期处理程序方法（组件的逻辑）。对于随机颜色组件，我们不会设置模式，因为它是不可配置的。但是我们将定义init处理程序，在附加组件时只调用一次：</p> <div class="language- extra-class"><pre class="language-text"><code>AFRAME.registerComponent('random-color', {
  init: function () {
    // ...
  }
});
</code></pre></div><p>对于随机颜色组件，我们希望在该组件所附加到的实体上设置随机颜色。组件从处理程序方法中引用具有this.el的实体。为了使用JavaScript更改颜色，我们使用.setAttribute（）更改材质组件的颜色属性。A-Frame稍微增强了几个domapi的行为，但这些api大多反映了普通的web开发。阅读有关在A-Frame中使用JavaScript和domapi的更多信息。</p> <p>我们还将把material组件添加到应该在此之前初始化的组件列表中，这样我们的材料就不会被覆盖。</p> <div class="language- extra-class"><pre class="language-text"><code>AFRAME.registerComponent('random-color', {
  dependencies: ['material'],

  init: function () {
    // Set material component's color property to a random color.
    this.el.setAttribute('material', 'color', getRandomColor());
  }
});

function getRandomColor() {
  const letters = '0123456789ABCDEF';
  var color = '#';
  for (var i = 0; i &lt; 6; i++ ) {
    color += letters[Math.floor(Math.random() * 16)];
  }
  return color;
}
</code></pre></div><p>组件注册后，我们可以直接从HTML附加此组件。在A-Frame框架中编写的所有代码都是扩展HTML的，这些扩展可以用于其他对象和场景中。最美妙的是，开发人员可以编写一个将物理添加到对象中的组件，然后甚至不知道JavaScript的人可以将物理添加到他们的场景中！</p> <p>以前面的box实体为例，我们附加了random color HTML属性来插入random color组件。我们将组件保存为JS文件，并在场景之前包含它：</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;script src=&quot;https://aframe.io/releases/1.0.4/aframe.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;components/random-color.js&quot;&gt;&lt;/script&gt;

&lt;a-scene&gt;
  &lt;a-assets&gt;
    &lt;img id=&quot;skyTexture&quot; src=&quot;https://cdn.aframe.io/a-painter/images/sky.jpg&quot;&gt;
  &lt;/a-assets&gt;

  &lt;!-- Box with random color. --&gt;
  &lt;a-entity geometry=&quot;primitive: box; depth: 0.5; height: 0.5; width 0.5&quot;
            material=&quot;shader: standard&quot;
            position=&quot;0 0.5 -2&quot;
            random-color&gt;&lt;/a-entity&gt;

  &lt;a-cylinder id=&quot;ground&quot; src=&quot;#groundTexture&quot; radius=&quot;30&quot; height=&quot;0.1&quot;&gt;&lt;/a-cylinder&gt;

  &lt;a-sky id=&quot;background&quot; src=&quot;#skyTexture&quot; theta-length=&quot;90&quot; radius=&quot;30&quot;&gt;&lt;/a-sky&gt;
&lt;/a-scene&gt;
</code></pre></div><p>组件可以插入到任何实体中，而不必像在传统继承中那样创建或扩展类。如果我们想附加它说，<a-sphere>或<a-obj-model>，我们可以！</a-obj-model></a-sphere></p> <div class="language- extra-class"><pre class="language-text"><code>&lt;!-- Reusing and attaching the random color component to other entities. --&gt;
&lt;a-sphere random-color&gt;&lt;/a-sphere&gt;
&lt;a-obj-model src=&quot;model.obj&quot; random-color&gt;&lt;/a-obj-model&gt;
</code></pre></div><p>如果我们想让其他人使用这个组件，我们也可以。我们从A-Frame注册中心的生态系统中提取了许多方便的组件，类似于Unity资产存储。如果我们使用组件开发我们的应用程序，那么我们所有的代码都是固有的模块化和可重用的！</p> <h2 id="捕捉组件"><a href="#捕捉组件" class="header-anchor">#</a> 捕捉组件</h2> <p>我们将有一个捕捉组件来将我们的框捕捉到网格，这样它们就不会重叠。我们不会详细介绍这个组件是如何实现的，但是您可以查看snap组件的源代码（20行JavaScript）。</p> <p>我们将捕捉组件附加到长方体上，使其每半米捕捉一次，并偏移长方体的中心：</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;a-entity
   geometry=&quot;primitive: box; height: 0.5; width: 0.5; depth: 0.5&quot;
   material=&quot;shader: standard&quot;
   random-color
   snap=&quot;offset: 0.25 0.25 0.25; snap: 0.5 0.5 0.5&quot;&gt;
   	
&lt;/a-entity&gt;
</code></pre></div><p>现在我们有了一个长方体实体，表示为一个组件束，可以用来描述场景中的所有体素。</p> <h2 id="混音"><a href="#混音" class="header-anchor">#</a> 混音</h2> <p>我们可以创建一个mixin来定义一个可重用的组件包。我们将使用<a-mixin>来描述它，而不是将对象添加到场景中的<a-entity>，该<a-mixin>可以重复使用来创建体素，如预制体：</a-mixin></a-entity></a-mixin></p> <div class="language- extra-class"><pre class="language-text"><code>&lt;script src=&quot;https://aframe.io/releases/1.0.4/aframe.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;components/random-color.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;components/snap.js&quot;&gt;&lt;/script&gt;

&lt;a-scene&gt;
  &lt;a-assets&gt;
    &lt;img id=&quot;groundTexture&quot; src=&quot;https://cdn.aframe.io/a-painter/images/floor.jpg&quot;&gt;
    &lt;img id=&quot;skyTexture&quot; src=&quot;https://cdn.aframe.io/a-painter/images/sky.jpg&quot;&gt;
    &lt;a-mixin id=&quot;voxel&quot;
       geometry=&quot;primitive: box; height: 0.5; width: 0.5; depth: 0.5&quot;
       material=&quot;shader: standard&quot;
       random-color
       snap=&quot;offset: 0.25 0.25 0.25; snap: 0.5 0.5 0.5&quot;&gt;&lt;/a-mixin&gt;
  &lt;/a-assets&gt;

  &lt;a-cylinder id=&quot;ground&quot; src=&quot;#groundTexture&quot; radius=&quot;30&quot; height=&quot;0.1&quot;&gt;&lt;/a-cylinder&gt;

  &lt;a-sky id=&quot;background&quot; src=&quot;#skyTexture&quot; theta-length=&quot;90&quot; radius=&quot;30&quot;&gt;&lt;/a-sky&gt;

  &lt;a-entity mixin=&quot;voxel&quot; position=&quot;-1 0 -2&quot;&gt;&lt;/a-entity&gt;
  &lt;a-entity mixin=&quot;voxel&quot; position=&quot;0 0 -2&quot;&gt;&lt;/a-entity&gt;
  &lt;a-entity mixin=&quot;voxel&quot; position=&quot;0 1 -2&quot;&gt;
    &lt;a-animation attribute=&quot;rotation&quot; to=&quot;0 360 0&quot; repeat=&quot;indefinite&quot;&gt;&lt;/a-animation&gt;
  &lt;/a-entity&gt;
  &lt;a-entity mixin=&quot;voxel&quot; position=&quot;1 0 -2&quot;&gt;&lt;/a-entity&gt;
&lt;/a-scene&gt;
</code></pre></div><p>我们用这个混合体添加了体素：</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;a-entity mixin=&quot;voxel&quot; position=&quot;-1 0 -2&quot;&gt;&lt;/a-entity&gt;
&lt;a-entity mixin=&quot;voxel&quot; position=&quot;0 0 -2&quot;&gt;&lt;/a-entity&gt;
&lt;a-entity mixin=&quot;voxel&quot; position=&quot;0 1 -2&quot;&gt;
  &lt;a-animation attribute=&quot;rotation&quot; to=&quot;0 360 0&quot; repeat=&quot;indefinite&quot;&gt;&lt;/a-animation&gt;
&lt;/a-entity&gt;
&lt;a-entity mixin=&quot;voxel&quot; position=&quot;1 0 -2&quot;&gt;&lt;/a-entity&gt;
</code></pre></div><p>接下来，我们将使用跟踪控制器通过交互动态创建体素。让我们开始在应用程序中添加人手。</p> <h2 id="添加手动控制器"><a href="#添加手动控制器" class="header-anchor">#</a> 添加手动控制器</h2> <p>添加HTC Vive或Oculus触摸跟踪控制器很容易：</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;!-- Vive. --&gt;
&lt;a-entity vive-controls=&quot;hand: left&quot;&gt;&lt;/a-entity&gt;
&lt;a-entity vive-controls=&quot;hand: right&quot;&gt;&lt;/a-entity&gt;

&lt;!-- Or Rift. --&gt;
&lt;a-entity oculus-touch-controls=&quot;hand: left&quot;&gt;&lt;/a-entity&gt;
&lt;a-entity oculus-touch-controls=&quot;hand: right&quot;&gt;&lt;/a-entity&gt;
</code></pre></div><p>我们将使用手控，它抽象并与Vive和Rift控件一起工作，提供基本手的模型。我们会让左手负责传送，右手负责产卵和放置积木。</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;a-entity id=&quot;teleHand&quot; hand-controls=&quot;left&quot;&gt;&lt;/a-entity&gt;
&lt;a-entity id=&quot;blockHand&quot; hand-controls=&quot;right&quot;&gt;&lt;/a-entity&gt;
</code></pre></div><h2 id="增加传送到左手"><a href="#增加传送到左手" class="header-anchor">#</a> 增加传送到左手</h2> <p>我们将在左手边插入隐形传送功能，这样我们就可以按住一个按钮来显示从控制器出来的弧线，然后松开按钮来隐形传送到弧线的末端。之前，我们编写了自己的A形框架组件。但是我们也可以使用已经从社区制作的开源组件，直接从HTML使用它们！</p> <p>对于远程传输，有一个由@fernandojsg提供的远程传输控制组件。在自述文件之后，我们通过<code>&lt;script&gt;</code>标签添加组件，并在实体上的控制器上设置teleport controls组件：</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;script src=&quot;https://aframe.io/releases/1.0.4/aframe.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://unpkg.com/aframe-teleport-controls@0.2.x/dist/aframe-teleport-controls.min.js&quot;&gt;&lt;/script&gt;

&lt;!-- ... --&gt;

&lt;a-entity id=&quot;teleHand&quot; hand-controls=&quot;left&quot; teleport-controls&gt;&lt;/a-entity&gt;
&lt;a-entity id=&quot;blockHand&quot; hand-controls=&quot;right&quot;&gt;&lt;/a-entity&gt;
</code></pre></div><p>然后我们将配置远程传输控制组件以使用弧形远程传输。默认情况下，远程传输控件将仅在地面上进行远程传输，但我们可以指定使用collisionEntities在块和地面上使用选择器进行远程传输。这些属性是创建teleport控件组件时使用的API的一部分：</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;a-entity id=&quot;teleHand&quot; hand-controls=&quot;left&quot; teleport-controls=&quot;type: parabolic; collisionEntities: [mixin='voxel'], #ground&quot;&gt;&lt;/a-entity&gt;

</code></pre></div><p>就这样！一个脚本标签和一个HTML属性，我们可以传送。有关更酷的组件，请查看A-Frame注册表。</p> <h2 id="将体素产卵器添加到右侧"><a href="#将体素产卵器添加到右侧" class="header-anchor">#</a> 将体素产卵器添加到右侧</h2> <p>在WebVR中，单击对象的功能并不像在2D应用程序中那样是内置的。我们必须自己提供。幸运的是，A-Frame有许多组件来处理交互。在虚拟现实中，像光标一样点击的一种常用方法是使用光线投射器，一种能够射出并返回与之相交的对象的激光。然后，我们通过监听交互事件并检查raycaster的交集来实现光标状态。</p> <p>A-Frame为控制器激光交互提供激光控制组件，将点击激光连接到虚拟现实跟踪控制器。像teleport控件组件一样，我们包含脚本标记并附加激光控件组件。这次是右手边：</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;script src=&quot;https://aframe.io/releases/1.0.4/aframe.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://unpkg.com/aframe-teleport-controls@0.2.x/dist/aframe-teleport-controls.min.js&quot;&gt;&lt;/script&gt;

&lt;!-- ... --&gt;

&lt;a-entity id=&quot;teleHand&quot; hand-controls=&quot;left&quot; teleport-controls=&quot;type: parabolic; collisionEntities: [mixin='voxel'], #ground&quot;&gt;&lt;/a-entity&gt;
&lt;a-entity id=&quot;blockHand&quot; hand-controls=&quot;right&quot; laser-controls&gt;&lt;/a-entity&gt;
</code></pre></div><p>现在，当我们按下被跟踪控制器上的触发按钮时，激光控制将在控制器和它当时相交的实体上发出一个点击事件。还提供了mouseenter、mouseleave等事件。事件包含有关交叉点的详细信息。</p> <p>这为我们提供了单击的能力，但是我们必须连接一些代码来处理这些单击以生成块。我们可以使用事件侦听器和document.createElement：</p> <div class="language- extra-class"><pre class="language-text"><code>document.querySelector('#blockHand').addEventListener(`click`, function (evt) {
  // Create a blank entity.
  var newVoxelEl = document.createElement('a-entity');

  // Use the mixin to make it a voxel.
  newVoxelEl.setAttribute('mixin', 'voxel');

  // Set the position using intersection point. The `snap` component above which
  // is part of the mixin will snap it to the closest half meter.
  newVoxelEl.setAttribute('position', evt.detail.intersection.point);

  // Add to the scene with `appendChild`.
  this.appendChild(newVoxelEl);
});
</code></pre></div><p>为了泛化从交叉点事件创建实体，我们创建了一个交叉点派生组件，该组件可以配置为任何事件和属性列表。我们不会详细介绍实现的细节，但是您可以在GitHub上查看简单的intersection spawn组件源代码。我们将交叉点生成功能附加到右侧：</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;a-entity id=&quot;blockHand&quot; hand-controls=&quot;right&quot; laser-controls intersection-spawn=&quot;event: click; mixin: voxel&quot;&gt;&lt;/a-entity&gt;

</code></pre></div><p>现在，当我们点击，我们产生体素！</p> <h2 id="添加对移动和桌面的支持"><a href="#添加对移动和桌面的支持" class="header-anchor">#</a> 添加对移动和桌面的支持</h2> <p>我们看到如何通过混合组件来构建一个自定义类型的对象（即，一个具有点击功能并在点击时生成块的手模型的跟踪手控制器）。组件的美妙之处在于它们可以在其他上下文中重用。我们甚至可以将交叉点生成组件附加到基于凝视的光标组件，这样我们也可以在移动和桌面上生成块，而不必更改组件的任何内容！</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;a-entity id=&quot;blockHand&quot; hand-controls=&quot;right&quot; laser-controls intersection-spawn=&quot;event: click; mixin: voxel&quot;&gt;&lt;/a-entity&gt;

&lt;a-camera&gt;
  &lt;a-cursor intersection-spawn=&quot;event: click; mixin: voxel&quot;&gt;&lt;/a-cursor&gt;
&lt;/a-camera&gt;
</code></pre></div></a-collinder></a-circle></a-plane></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.db1f5619.js" defer></script><script src="/assets/js/2.136755fd.js" defer></script><script src="/assets/js/75.8afa1dc5.js" defer></script>
  </body>
</html>
