<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ECS框架 | aiplayer</title>
    <meta name="description" content="aiplayer portal">
    <meta name="generator" content="VuePress 1.4.0">
    
    
    <link rel="preload" href="/assets/css/0.styles.f0b62ee8.css" as="style"><link rel="preload" href="/assets/js/app.db1f5619.js" as="script"><link rel="preload" href="/assets/js/2.136755fd.js" as="script"><link rel="preload" href="/assets/js/24.3fb5d63e.js" as="script"><link rel="prefetch" href="/assets/js/10.d8e1a177.js"><link rel="prefetch" href="/assets/js/100.a1569435.js"><link rel="prefetch" href="/assets/js/101.df4254c0.js"><link rel="prefetch" href="/assets/js/102.7238a621.js"><link rel="prefetch" href="/assets/js/103.6066a045.js"><link rel="prefetch" href="/assets/js/104.19e5f9ce.js"><link rel="prefetch" href="/assets/js/105.1da234c6.js"><link rel="prefetch" href="/assets/js/106.205e3402.js"><link rel="prefetch" href="/assets/js/107.175ad760.js"><link rel="prefetch" href="/assets/js/108.a9ac042b.js"><link rel="prefetch" href="/assets/js/109.424d5783.js"><link rel="prefetch" href="/assets/js/11.934355de.js"><link rel="prefetch" href="/assets/js/110.c7bca671.js"><link rel="prefetch" href="/assets/js/111.73c2c60a.js"><link rel="prefetch" href="/assets/js/112.7f5490ea.js"><link rel="prefetch" href="/assets/js/113.14375c6f.js"><link rel="prefetch" href="/assets/js/114.3363197a.js"><link rel="prefetch" href="/assets/js/115.02afb483.js"><link rel="prefetch" href="/assets/js/116.29a7b694.js"><link rel="prefetch" href="/assets/js/117.5be07a33.js"><link rel="prefetch" href="/assets/js/118.0702142c.js"><link rel="prefetch" href="/assets/js/119.6402e457.js"><link rel="prefetch" href="/assets/js/12.c2bc3227.js"><link rel="prefetch" href="/assets/js/120.ac365fc7.js"><link rel="prefetch" href="/assets/js/121.fb021e50.js"><link rel="prefetch" href="/assets/js/122.9fe3b1ea.js"><link rel="prefetch" href="/assets/js/123.27e74ba8.js"><link rel="prefetch" href="/assets/js/124.1d2e32db.js"><link rel="prefetch" href="/assets/js/125.04e7f173.js"><link rel="prefetch" href="/assets/js/126.27d517fd.js"><link rel="prefetch" href="/assets/js/127.64ce51be.js"><link rel="prefetch" href="/assets/js/128.5c40af31.js"><link rel="prefetch" href="/assets/js/129.8e36099a.js"><link rel="prefetch" href="/assets/js/13.30b2fd23.js"><link rel="prefetch" href="/assets/js/130.4404aeed.js"><link rel="prefetch" href="/assets/js/131.9a6be204.js"><link rel="prefetch" href="/assets/js/132.621634ca.js"><link rel="prefetch" href="/assets/js/133.4b393036.js"><link rel="prefetch" href="/assets/js/134.dcc9e5f3.js"><link rel="prefetch" href="/assets/js/135.cdc08eed.js"><link rel="prefetch" href="/assets/js/136.d1361c7f.js"><link rel="prefetch" href="/assets/js/137.70e249cd.js"><link rel="prefetch" href="/assets/js/138.ab5deb19.js"><link rel="prefetch" href="/assets/js/139.11778cf5.js"><link rel="prefetch" href="/assets/js/14.2125223a.js"><link rel="prefetch" href="/assets/js/140.db04184d.js"><link rel="prefetch" href="/assets/js/141.f31f6358.js"><link rel="prefetch" href="/assets/js/142.46e9b5b9.js"><link rel="prefetch" href="/assets/js/143.fa46c1c3.js"><link rel="prefetch" href="/assets/js/144.578e8fe1.js"><link rel="prefetch" href="/assets/js/145.d92b6019.js"><link rel="prefetch" href="/assets/js/146.7959a0f8.js"><link rel="prefetch" href="/assets/js/147.bddc1b3f.js"><link rel="prefetch" href="/assets/js/148.226bfada.js"><link rel="prefetch" href="/assets/js/149.d8549551.js"><link rel="prefetch" href="/assets/js/15.fb8b9ae9.js"><link rel="prefetch" href="/assets/js/150.9e86241e.js"><link rel="prefetch" href="/assets/js/151.796f1274.js"><link rel="prefetch" href="/assets/js/152.d257e8a9.js"><link rel="prefetch" href="/assets/js/153.03854e57.js"><link rel="prefetch" href="/assets/js/154.36494ed7.js"><link rel="prefetch" href="/assets/js/155.a4c0d865.js"><link rel="prefetch" href="/assets/js/156.a5570edb.js"><link rel="prefetch" href="/assets/js/157.d5cfe341.js"><link rel="prefetch" href="/assets/js/16.4840c375.js"><link rel="prefetch" href="/assets/js/17.3db7187c.js"><link rel="prefetch" href="/assets/js/18.3f978365.js"><link rel="prefetch" href="/assets/js/19.0a024717.js"><link rel="prefetch" href="/assets/js/20.8bce2b97.js"><link rel="prefetch" href="/assets/js/21.eb505a2a.js"><link rel="prefetch" href="/assets/js/22.ad76dfcb.js"><link rel="prefetch" href="/assets/js/23.c086b548.js"><link rel="prefetch" href="/assets/js/25.5595455f.js"><link rel="prefetch" href="/assets/js/26.f94f11ad.js"><link rel="prefetch" href="/assets/js/27.f289b5d4.js"><link rel="prefetch" href="/assets/js/28.6eb0556e.js"><link rel="prefetch" href="/assets/js/29.8defe1c0.js"><link rel="prefetch" href="/assets/js/3.28f81bc4.js"><link rel="prefetch" href="/assets/js/30.8ab8f249.js"><link rel="prefetch" href="/assets/js/31.33b536a9.js"><link rel="prefetch" href="/assets/js/32.7df14067.js"><link rel="prefetch" href="/assets/js/33.fbabe129.js"><link rel="prefetch" href="/assets/js/34.53ff114a.js"><link rel="prefetch" href="/assets/js/35.f2c39ebd.js"><link rel="prefetch" href="/assets/js/36.467f6b09.js"><link rel="prefetch" href="/assets/js/37.9e1dd23b.js"><link rel="prefetch" href="/assets/js/38.068c85f4.js"><link rel="prefetch" href="/assets/js/39.b1e0fefa.js"><link rel="prefetch" href="/assets/js/4.8934782b.js"><link rel="prefetch" href="/assets/js/40.bb170fba.js"><link rel="prefetch" href="/assets/js/41.f3ae6a10.js"><link rel="prefetch" href="/assets/js/42.bb54411b.js"><link rel="prefetch" href="/assets/js/43.3c863cb9.js"><link rel="prefetch" href="/assets/js/44.7060ca63.js"><link rel="prefetch" href="/assets/js/45.f3047d76.js"><link rel="prefetch" href="/assets/js/46.9c09c0ab.js"><link rel="prefetch" href="/assets/js/47.5202a7c1.js"><link rel="prefetch" href="/assets/js/48.6e8df322.js"><link rel="prefetch" href="/assets/js/49.0cc3d23d.js"><link rel="prefetch" href="/assets/js/5.a0353814.js"><link rel="prefetch" href="/assets/js/50.3b307fd5.js"><link rel="prefetch" href="/assets/js/51.4fbbe6c7.js"><link rel="prefetch" href="/assets/js/52.331937fe.js"><link rel="prefetch" href="/assets/js/53.dc7c275c.js"><link rel="prefetch" href="/assets/js/54.4f85d82e.js"><link rel="prefetch" href="/assets/js/55.1643757b.js"><link rel="prefetch" href="/assets/js/56.ef32a88b.js"><link rel="prefetch" href="/assets/js/57.c7121932.js"><link rel="prefetch" href="/assets/js/58.16441501.js"><link rel="prefetch" href="/assets/js/59.4e5591f5.js"><link rel="prefetch" href="/assets/js/6.fa571ebd.js"><link rel="prefetch" href="/assets/js/60.967020e8.js"><link rel="prefetch" href="/assets/js/61.71d79f42.js"><link rel="prefetch" href="/assets/js/62.88671447.js"><link rel="prefetch" href="/assets/js/63.7f40e91d.js"><link rel="prefetch" href="/assets/js/64.ef23913e.js"><link rel="prefetch" href="/assets/js/65.63a29bbb.js"><link rel="prefetch" href="/assets/js/66.9f830dea.js"><link rel="prefetch" href="/assets/js/67.0783e6f9.js"><link rel="prefetch" href="/assets/js/68.edb28c91.js"><link rel="prefetch" href="/assets/js/69.58a85f29.js"><link rel="prefetch" href="/assets/js/7.b690ca65.js"><link rel="prefetch" href="/assets/js/70.58d4adb6.js"><link rel="prefetch" href="/assets/js/71.0e2e4dba.js"><link rel="prefetch" href="/assets/js/72.ee7e2979.js"><link rel="prefetch" href="/assets/js/73.935f8492.js"><link rel="prefetch" href="/assets/js/74.d69c06e4.js"><link rel="prefetch" href="/assets/js/75.8afa1dc5.js"><link rel="prefetch" href="/assets/js/76.48c0a6d0.js"><link rel="prefetch" href="/assets/js/77.5e0afc33.js"><link rel="prefetch" href="/assets/js/78.9cb7dc28.js"><link rel="prefetch" href="/assets/js/79.83ec5e2e.js"><link rel="prefetch" href="/assets/js/8.f127e12e.js"><link rel="prefetch" href="/assets/js/80.3776af5c.js"><link rel="prefetch" href="/assets/js/81.539223a8.js"><link rel="prefetch" href="/assets/js/82.ecd88fed.js"><link rel="prefetch" href="/assets/js/83.8b8f52b1.js"><link rel="prefetch" href="/assets/js/84.56e7b62b.js"><link rel="prefetch" href="/assets/js/85.602daf28.js"><link rel="prefetch" href="/assets/js/86.8983b155.js"><link rel="prefetch" href="/assets/js/87.92548279.js"><link rel="prefetch" href="/assets/js/88.1683e878.js"><link rel="prefetch" href="/assets/js/89.57d67dae.js"><link rel="prefetch" href="/assets/js/9.beeca559.js"><link rel="prefetch" href="/assets/js/90.86c4ccad.js"><link rel="prefetch" href="/assets/js/91.b97628b5.js"><link rel="prefetch" href="/assets/js/92.13b4c677.js"><link rel="prefetch" href="/assets/js/93.91e9ad39.js"><link rel="prefetch" href="/assets/js/94.bfd2d19e.js"><link rel="prefetch" href="/assets/js/95.89405747.js"><link rel="prefetch" href="/assets/js/96.de120589.js"><link rel="prefetch" href="/assets/js/97.72fa8b0f.js"><link rel="prefetch" href="/assets/js/98.debed4eb.js"><link rel="prefetch" href="/assets/js/99.992e6d93.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f0b62ee8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">aiplayer</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/arjs/" class="nav-link">
  AR.js
</a></div><div class="nav-item"><a href="/aframe/" class="nav-link router-link-active">
  aframe
</a></div><div class="nav-item"><a href="/nunustudio/" class="nav-link">
  nunuStudio
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  关于
</a></div> <a href="https://github.com/aiplayer/aiplayer.github.io.git" target="_blank" rel="noopener noreferrer" class="repo-link">
    Aiplayer
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/arjs/" class="nav-link">
  AR.js
</a></div><div class="nav-item"><a href="/aframe/" class="nav-link router-link-active">
  aframe
</a></div><div class="nav-item"><a href="/nunustudio/" class="nav-link">
  nunuStudio
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  关于
</a></div> <a href="https://github.com/aiplayer/aiplayer.github.io.git" target="_blank" rel="noopener noreferrer" class="repo-link">
    Aiplayer
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>aframe</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/aframe/" class="sidebar-link">AFrame:构建VR应用框架</a></li><li><a href="/aframe/aframe-base.html" class="sidebar-link">AFrame基础</a></li><li><a href="/aframe/aframe-guide.html" class="sidebar-link">开发指南</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>API</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/aframe/aframe-api.html" class="sidebar-link">核心API</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>组件</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/aframe/aframe-component.html" class="sidebar-link">组件</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>原语</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/aframe/aframe-primitive.html" class="sidebar-link">AFrame基础控件</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="ecs框架"><a href="#ecs框架" class="header-anchor">#</a> ECS框架</h1> <p>A-Frame是一个具有实体组件系统（ECS）架构的3.js框架。ECS架构是3D和游戏开发中一种常见的、理想的模式，遵循的是超越继承和层次的组合原则。</p> <p>ECS的好处包括：</p> <ul><li><p>通过混合和匹配可重用部件来定义对象时具有更大的灵活性。</p></li> <li><p>消除了复杂交织功能的长继承链问题。</p></li> <li><p>通过解耦、封装、模块化、可重用性来促进清洁设计。</p></li> <li><p>从复杂性的角度来看，构建虚拟现实应用程序的最具伸缩性的方法。</p></li> <li><p>经过验证的3D和虚拟现实开发架构。</p></li> <li><p>允许扩展新功能（可能将它们作为社区组件共享）。</p></li></ul> <p>在2dweb上，我们在层次结构中布局具有固定行为的元素。3D和VR是不同的；有无限类型的可能对象具有无限的行为。ECS提供了一个可管理的模式来构造对象类型。</p> <p>以下是ECS架构的优秀入门资料。我们建议浏览一下，以便更好地了解这些好处。ECS非常适合虚拟现实开发，A-Frame完全基于这种模式：</p> <ul><li><p>维基百科实体构件系统</p></li> <li><p>什么是实体系统？亚当·马丁</p></li> <li><p>解耦模式-游戏编程模式的组件</p></li> <li><p>由米克韦斯特发展你的等级制度</p></li></ul> <p>实现ECS的著名游戏引擎是Unity。尽管在跨实体通信中存在一些难点，但我们将看到A-Frame、DOM和声明性HTML如何真正使ECS发光。</p> <h2 id="概念"><a href="#概念" class="header-anchor">#</a> 概念</h2> <p>ECS的基本定义包括：</p> <ul><li><p>实体是可以附加组件的容器对象。实体是场景中所有对象的基础。如果没有组件，实体既不会也不会呈现任何内容，类似于empty</p><div>s。<p></p></div></li> <li><p>组件是可重用的模块或数据容器，可以附加到实体以提供外观、行为和/或功能。组件就像对象的即插即用。所有逻辑都是通过组件实现的，我们通过混合、匹配和配置组件来定义不同类型的对象。就像炼金术！</p></li> <li><p>系统为组件类提供全局范围、管理和服务。系统通常是可选的，但是我们可以使用它们来分离逻辑和数据；系统处理逻辑，组件充当数据容器。</p></li></ul> <h2 id="例子"><a href="#例子" class="header-anchor">#</a> 例子</h2> <p>通过组合不同组件构建的不同类型实体的一些抽象示例：</p> <ul><li>Box = Position + Geometry + Material</li> <li>Light Bulb = Position + Light + Geometry + Material + Shadow</li> <li>Sign = Position + Geometry + Material + Text</li> <li>VR Controller = Position + Rotation + Input + Model + Grab + Gestures</li> <li>Ball = Position + Velocity + Physics + Geometry + Material</li> <li>Player = Position + Camera + Input + Avatar + Identity</li></ul> <p>另一个抽象的例子是，假设我们想通过组装组件来构建一个汽车实体：</p> <ul><li><p>我们可以附加一个具有影响汽车外观的“颜色”或“光泽”等特性的材料组件。</p></li> <li><p>我们可以附加一个发动机部件，它具有影响汽车功能的“马力”或“重量”等特性。</p></li> <li><p>我们可以附加一个轮胎部件，它具有“轮胎数量”或“转向角”等影响汽车性能的特性。</p></li></ul> <p>因此，我们可以通过改变材料、发动机和轮胎部件的特性来制造不同类型的汽车。材料、发动机和轮胎部件不必相互了解，甚至可以单独用于其他情况。我们可以将它们混合搭配，创造出甚至不同类型的车辆：</p> <ul><li><p>创建船实体：移除轮胎组件。</p></li> <li><p>创建摩托车实体：将轮胎组件的轮胎数更改为2，将发动机组件配置为更小。</p></li> <li><p>创建飞机实体：附加机翼和喷气组件。</p></li></ul> <p>与传统的继承相比，如果我们想扩展一个对象，我们就必须创建一个大型类来处理所有事情或继承链。</p> <h2 id="a-frame中的ecs"><a href="#a-frame中的ecs" class="header-anchor">#</a> A-Frame中的ECS</h2> <p>A-Frame有代表每台ECS的api：</p> <ul><li><p>实体由<a-entity>元素和原型表示。</a-entity></p></li> <li><p>组件由<a-entity>上的HTML属性表示。下面，组件是包含模式、生命周期处理程序和方法的对象。组件通过AFRAME.registerComponent（name,definition）API注册。</a-entity></p></li> <li><p>系统由<a-scene>的HTML属性表示。系统在定义上类似于组件。系统通过AFRAME.registerSystem（name,definition）API注册。</a-scene></p></li></ul> <h2 id="语法"><a href="#语法" class="header-anchor">#</a> 语法</h2> <p>我们创建<a-entity>并将组件作为HTML属性附加。大多数组件都有多个属性，这些属性由类似HTMLElement.StyleCSS的语法表示。此语法采用冒号（：）分隔属性名称和属性值的形式，分号（；）分隔不同的属性声明：</a-entity></p> <div class="language- extra-class"><pre class="language-text"><code>&lt;a-entity ${componentName}=&quot;${propertyName1}: ${propertyValue1}; ${propertyName2}: ${propertyValue2}&quot;&gt;

</code></pre></div><p>例如，我们有<a-entity>并附加具有各种属性和属性值的几何体、材质、灯光和位置组件：</a-entity></p> <div class="language- extra-class"><pre class="language-text"><code>&lt;a-entity geometry=&quot;primitive: sphere; radius: 1.5&quot;
          light=&quot;type: point; color: white; intensity: 2&quot;
          material=&quot;color: white; shader: flat; src: glow.jpg&quot;
          position=&quot;0 0 -5&quot;&gt;&lt;/a-entity&gt;

</code></pre></div><h2 id="组合"><a href="#组合" class="header-anchor">#</a> 组合</h2> <p>这样，我们可以附加更多的组件来添加额外的外观、行为或功能（例如，物理）。或者我们可以更新组件值来配置实体（声明性的或通过.setAttribute）。</p> <p>由多个组件组成的一种常见实体类型是虚拟现实中玩家的手。玩家的手可以有许多组件：外观、手势、行为、与其他对象的交互。</p> <p>我们将组件插入到一个hand实体中，以提供它的行为，就好像我们在为VR附加超能力或增强一样！下面的每个组件彼此不了解，但可以组合起来定义一个复杂的实体：</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;a-entity
  tracked-controls  &lt;!-- Hook into the Gamepad API for pose. --&gt;
  vive-controls  &lt;!-- Vive button mappings. --&gt;
  oculus-touch-controls  &lt;!-- Oculus button mappings. --&gt;
  hand-controls  &lt;!-- Appearance (model), gestures, and events. --&gt;
  laser-controls &lt;!-- Laser to interact with menus and UI. --&gt;
  sphere-collider  &lt;!-- Listen when hand is in contact with an object. --&gt;
  grab  &lt;!-- Provide ability to grab objects. --&gt;
  throw &lt;!-- Provide ability to throw objects. --&gt;
  event-set=&quot;_event: grabstart; visible: false&quot;  &lt;!-- Hide hand when grabbing object. --&gt;
  event-set=&quot;_event: grabend; visible: true&quot;  &lt;!-- Show hand when no longer grabbing object. --&gt;
&gt;

</code></pre></div><h2 id="基于dom声明式ecs"><a href="#基于dom声明式ecs" class="header-anchor">#</a> 基于DOM声明式ECS</h2> <p>A-Frame通过使ECS具有声明性并基于DOM将其带到另一个级别。传统上，基于ECS的引擎会通过代码创建实体、附加组件、更新组件、删除组件。但是A-Frame有HTML和DOM，这使得ECS符合人体工程学，解决了它的许多弱点。以下是DOM为ECS提供的功能：</p> <p>使用查询选择器引用其他实体：DOM提供了一个强大的查询选择器系统，允许我们查询场景图并选择一个或多个符合条件的实体。我们可以通过id、类或数据属性获取对实体的引用。因为A-Frame是基于HTML的，所以我们可以使用开箱即用的查询选择器。document.querySelector（'#player'）。</p> <p>与事件分离的跨实体通信：DOM提供了监听和发出事件的能力。这提供了实体之间的发布-订阅通信系统。组件不必知道彼此，它们只需发出一个事件（可能会冒泡），其他组件可以监听这些事件而不调用对方。ball.emit（“碰撞”）。</p> <p>使用domapi进行生命周期管理的api:DOM提供了用于更新HTML元素和树的api，包括.setAttribute、.removeAttribute、.createElement和.removeChild。这些可以像在正常的web开发中一样使用。</p> <p>使用属性选择器进行实体过滤：DOM提供属性选择器，允许我们查询具有或不具有特定HTML属性的一个或多个实体。这意味着我们可以请求具有或不具有特定组件集的实体。document.querySelector（'[敌人]：不是（[活着]）。</p> <p>声明性：最后，DOM提供HTML。在ECS和HTML之间建立一个A-Frame桥，使得一个已经很干净的模式具有声明性、可读性、可复制和可粘贴</p> <div class="language- extra-class"><pre class="language-text"><code>AFRAME.registerComponent('foo', {
  schema: {
    bar: {type: 'number'},
    baz: {type: 'string'}
  },

  init: function () {
    // Do something when component first attached.
  },

  update: function () {
    // Do something when component's data is updated.
  },

  remove: function () {
    // Do something the component or its entity is detached.
  },

  tick: function (time, timeDelta) {
    // Do something on every scene tick or frame.
  }
});

</code></pre></div><p>声明式ECS允许我们编写JavaScript模块并通过HTML抽象它。一旦注册了组件，我们就可以通过一个HTML属性声明性地将这个代码模块插入到一个实体中。这种代码到HTML的抽象使得ECS功能强大，易于推理。foo是我们刚刚注册的组件的名称，数据包含bar和baz属性：</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;a-entity foo=&quot;bar: 5; baz: bazValue&quot;&gt;&lt;/a-entity&gt;

</code></pre></div><h3 id="基于组件开发"><a href="#基于组件开发" class="header-anchor">#</a> 基于组件开发</h3> <p>对于构建虚拟现实应用程序，我们建议将所有应用程序代码放在组件（和系统）中。理想的A帧代码库完全由模块化、封装和分离的组件组成。这些组件可以单独或与其他组件一起进行单元测试。</p> <p>当一个应用程序仅仅由组件创建时，它的代码库的所有部分都可以重用！组件可以共享给其他开发人员使用，或者我们可以在其他项目中重用它们。或者组件可以分叉和修改以适应其他用例。</p> <p>一个简单的ECS代码库的结构可能如下：</p> <div class="language- extra-class"><pre class="language-text"><code>index.html
components/
  ball.js
  collidable.js
  grabbable.js
  enemy.js
  scoreboard.js
  throwable.js
</code></pre></div><h3 id="高阶组件"><a href="#高阶组件" class="header-anchor">#</a> 高阶组件</h3> <p>组件可以在实体上设置其他组件，使它们成为抽象的更高阶或更高级别的组件。</p> <p>例如，光标组件设置并构建在光线投射器组件的顶部。或者hand controls组件设置并构建在vive controls组件和oculus touch controls组件之上，而oculus touch controls组件又构建在tracked controls组件之上。</p> <h3 id="社区组件生态"><a href="#社区组件生态" class="header-anchor">#</a> 社区组件生态</h3> <p>组件可以共享到A-Frame生态系统中供社区使用。A-Frame的ECS的优点是可扩展性。一个有经验的开发人员可以开发一个物理系统或图形着色器组件，而一个新手开发人员只需输入一个<code>&lt;script&gt;</code>标记，就可以从HTML中获取这些组件并在场景中使用它们。我们可以使用强大的已发布组件，而无需接触JavaScript。</p> <h3 id="在何处查找组件"><a href="#在何处查找组件" class="header-anchor">#</a> 在何处查找组件</h3> <p>野外有数百种成分。我们尽力让他们被发现。如果你开发了一个组件，请通过这些渠道提交分享！</p> <h4 id="npm"><a href="#npm" class="header-anchor">#</a> NPM</h4> <p>大多数A-Frame组件都发布在npm和GitHub上。我们可以使用npm的搜索来搜索aframe组件。npm允许我们按质量、流行度和维护进行排序。这是一个寻找更完整组件列表的好地方。</p> <h4 id="github"><a href="#github" class="header-anchor">#</a> github</h4> <p>许多A-Frame应用程序纯粹是从组件开发的，其中许多A-Frame应用程序都是在GitHub上开源的。它们的代码库将包含我们可以直接使用、引用或复制的组件。要查看的项目包括：</p> <ul><li>BeatSaver Viewer</li> <li>Super Says</li> <li>A-Painter</li> <li>A-Blast</li></ul> <h3 id="使用社区组件"><a href="#使用社区组件" class="header-anchor">#</a> 使用社区组件</h3> <p>找到要使用的组件后，我们可以将该组件作为<code>&lt;script&gt;</code>标记包含并从HTML中使用它。</p> <p>例如，让我们使用IdeaSpaceVR的粒子系统组件：</p> <h4 id="使用unpkg"><a href="#使用unpkg" class="header-anchor">#</a> 使用unpkg</h4> <p>首先，我们必须获取指向组件JS文件的CDN链接。组件的文档通常有一个CDN链接或使用信息。获得最新CDN链接的一种方法是使用<code>unpkg.com</code>。</p> <p>unpkg是一个CDN，它自动承载发布到npm的所有内容。unpkg可以解析语义版本控制，并为我们提供所需组件的版本。URL的形式为：</p> <div class="language- extra-class"><pre class="language-text"><code>https://unpkg.com/&lt;npm package name&gt;@&lt;version&gt;/&lt;path to file&gt;
</code></pre></div><p>如果要使用最新版本，可以去掉version</p> <div class="language- extra-class"><pre class="language-text"><code>https://unpkg.com/&lt;npm package name&gt;/&lt;path to file&gt;
</code></pre></div><p>我们可以排除path to file来浏览组件包的目录，而不是键入构建组件JS文件的路径。JS文件通常位于名为dist/或build/的文件夹中，以.min.JS结尾。</p> <p>对于粒子系统组件，我们将转到：</p> <div class="language- extra-class"><pre class="language-text"><code>https://unpkg.com/aframe-particle-system-component/

</code></pre></div><p>注意结尾的斜线（/）。找到我们需要的文件，右击，点击复制链接地址，将CDN链接复制到剪贴板。</p> <h4 id="引入组件js文件"><a href="#引入组件js文件" class="header-anchor">#</a> 引入组件JS文件</h4> <p>然后转到我们的HTML。在<code>&lt;head&gt;</code>下面、A-Frame JS<code>&lt;script&gt;</code>标记之后和<A-scene>之前，我们将使用<code>&lt;script&gt;</code>标记包含JS文件。</A-scene></p> <p>对于粒子系统组件，我们之前（在编写时）发现的CDN链接是：</p> <div class="language- extra-class"><pre class="language-text"><code>https://unpkg.com/aframe-particle-system-component@1.0.9/dist/aframe-particle-system-component.min.js
</code></pre></div><p>现在我们可以将其包含到我们的HTML中：</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;html&gt;
  &lt;head&gt;
    &lt;script src=&quot;https://aframe.io/releases/1.0.4/aframe.min.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;https://unpkg.com/aframe-particle-system-component@1.0.9/dist/aframe-particle-system-component.min.js&quot;&gt;&lt;/script&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;a-scene&gt;
    &lt;/a-scene&gt;
  &lt;/body&gt;
&lt;/html&gt;

</code></pre></div><h4 id="使用组件"><a href="#使用组件" class="header-anchor">#</a> 使用组件</h4> <p>按照组件的文档说明如何在实现中使用它。但通常情况下，这种用法涉及将组件附加到实体并对其进行配置。对于粒子系统组件：</p> <p>现在我们可以将其包含到我们的HTML中：</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;html&gt;
  &lt;head&gt;
    &lt;script src=&quot;https://aframe.io/releases/1.0.4/aframe.min.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;https://unpkg.com/aframe-particle-system-component@1.0.9/dist/aframe-particle-system-component.min.js&quot;&gt;&lt;/script&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;a-scene&gt;
      &lt;a-entity particle-system=&quot;preset: snow&quot; position=&quot;0 0 -10&quot;&gt;&lt;/a-entity&gt;
    &lt;/a-scene&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre></div><h4 id="例子-2"><a href="#例子-2" class="header-anchor">#</a> 例子</h4> <p>下面是使用注册表中的各种社区组件和使用unpkg CDN的完整示例。我们可以重新混音或看看这个小故障的例子。</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;html&gt;
  &lt;head&gt;
    &lt;script src=&quot;https://aframe.io/releases/1.0.4/aframe.min.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;https://unpkg.com/aframe-animation-component@3.2.1/dist/aframe-animation-component.min.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;https://unpkg.com/aframe-particle-system-component@1.0.x/dist/aframe-particle-system-component.min.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;https://unpkg.com/aframe-extras.ocean@%5E3.5.x/dist/aframe-extras.ocean.min.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;https://unpkg.com/aframe-gradient-sky@1.0.4/dist/gradientsky.min.js&quot;&gt;&lt;/script&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;a-scene&gt;
      &lt;a-entity id=&quot;rain&quot; particle-system=&quot;preset: rain; color: #24CAFF; particleCount: 5000&quot;&gt;&lt;/a-entity&gt;

      &lt;a-entity id=&quot;sphere&quot; geometry=&quot;primitive: sphere&quot;
                material=&quot;color: #EFEFEF; shader: flat&quot;
                position=&quot;0 0.15 -5&quot;
                light=&quot;type: point; intensity: 5&quot;
                animation=&quot;property: position; easing: easeInOutQuad; dir: alternate; dur: 1000; to: 0 -0.10 -5; loop: true&quot;&gt;&lt;/a-entity&gt;

      &lt;a-entity id=&quot;ocean&quot; ocean=&quot;density: 20; width: 50; depth: 50; speed: 4&quot;
                material=&quot;color: #9CE3F9; opacity: 0.75; metalness: 0; roughness: 1&quot;
                rotation=&quot;-90 0 0&quot;&gt;&lt;/a-entity&gt;

      &lt;a-entity id=&quot;sky&quot; geometry=&quot;primitive: sphere; radius: 5000&quot;
                material=&quot;shader: gradient; topColor: 235 235 245; bottomColor: 185 185 210&quot;
                scale=&quot;-1 1 1&quot;&gt;&lt;/a-entity&gt;

      &lt;a-entity id=&quot;light&quot; light=&quot;type: ambient; color: #888&quot;&gt;&lt;/a-entity&gt;
    &lt;/a-scene&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.db1f5619.js" defer></script><script src="/assets/js/2.136755fd.js" defer></script><script src="/assets/js/24.3fb5d63e.js" defer></script>
  </body>
</html>
